# Use this only if you want to replace the default that is .Chart.Name as the name of all the objects.
image:
  repository: docker.io/flanksource/incident-commander
  pullPolicy: IfNotPresent
  tag: "v0.0.439"

global:
  otel:
    collector: ""

serviceAccount:
  # Annotations to add to the service account
  annotations: {}

otel:
  # OpenTelemetry gRPC collector endpoint in host:port format
  collector: "{{.Values.global.otel.collector}}"
  serviceName: "mission-control"

smtp:
  secretRef:
    name: incident-commander-smtp

# If true, creates secret
upstream:
  createSecret: true
  host: ""
  username: ""
  password: ""
  secretName: upstream

resources:
  requests:
    cpu: 100m
    memory: 768Mi
  limits:
    memory: 1024Mi
    cpu: 500m

db:
  create: true
  conf:
    max_connections: 200
    shared_buffers: 1GB
    effective_cache_size: 3GB
    maintenance_work_mem: 256MB
    wal_buffers: 16MB
    effective_io_concurrency: 200
    work_mem: 10MB
    max_wal_size: 4GB
    log_autovacuum_min_duration: 0
    log_connections: on
    log_destination: "csvlog"
    log_directory: "/var/log/postgresql"
    log_file_mode: 0640
    log_filename: "postgresql.log"
    log_line_prefix: "%h %m [%p] %q%u@%d "
    log_lock_waits: on
    log_min_duration_statement: "1s"
    log_rotation_age: 0
    log_rotation_size: 0
    log_statement: "all"
    log_temp_files: 0
    log_timezone: "UTC"
    logging_collector: on
    ssl: off
    timezone: "UTC"
    password_encryption: scram-sha-256
    db_user_namespace: off
    extra_float_digits: 0
  secretKeyRef:
    name: incident-commander-postgres
    key: DB_URL
  jwtSecretKeyRef:
    name: incident-commander-postgrest-jwt
    key: PGRST_JWT_SECRET
  storageClass:
  storage: 20Gi
  shmVolume: 256Mi
  resources:
    requests:
      memory: 4Gi

canary-checker:
  image:
    type: full
  upstream:
    enabled: true
    agentName: "default-agent"
    secretKeyRef:
      name: upstream
  db:
    runMigrations: false
    external:
      enabled: true
      create: false
      secretKeyRef:
        name: incident-commander-postgres
        key: DB_URL
  flanksource-ui:
    # Disable canary-checker by default.
    enabled: false

config-db:
  disablePostgrest: true
  db:
    runMigrations: false
    embedded:
      persist: false
    external:
      enabled: true
      secretKeyRef:
        name: incident-commander-postgres
        key: DB_URL
  upstream:
    enabled: true
    secretKeyRef:
      name: upstream
    agentName: default-agent
    pageSize: 500
